{% extends 'footer_header/base.html' %}
{% load static %}

{% block title %}
  Requests | Family+
{% endblock %}

{% block content %}

<body>
  <section style="background-color: #f0f2f5; height: 100vh; padding-right: 280px; padding-left: 280px;">
    <div class="container-fluid">
      <h4 style="text-align: center;">Requests Page Creation In Progress...</h4>
        
      <!-- Total number of pending requests waiting for the user's response -->
      {% if total_pending == 0 %}
        No pending requests.
      {% elif total_pending == 1 %}
        You have {{ total_pending }} pending request.
      {% else %}
        You have {{ total_pending }} pending requests.
      {% endif %}

      {% for sender in received_requests %}
        <div class="card">
          <div class="row" style="height: 200px">
            <div class="col-md-3 container-fluid">
              <div class="card-img">
                {% if sender.familyprofile.profile_image %}
                  <img src="{{ sender.familyprofile.profile_image.url }}" class="card-img" style="height: 200px">
                {% else %}
                  <img src="{% static 'website/images/default_profile_img/plain_default3.jpg' %}" class="card-img" style="height: 200px">
                {% endif %}
              </div>
            </div>
          
            <div class="col-md-8 container-fluid">
              <div class="card-body">
                <div class="card-body">
                  <h4>{{ sender.familyprofile.family_name|title }} Family</h4>
                  <form action="{% url 'accept-request' sender.familyprofile.pk %}" method="POST">{% csrf_token %}
                    <button type="submit", name="profile_id_4", value="{{ sender.familyprofile.id }}" class="btn btn-primary">
                      Accept Connection
                    </button>
                  </form>
                  <form action="{% url 'decline-request' sender.familyprofile.pk %}" method="POST">{% csrf_token %}
                    <button type="submit", name="profile_id_5", value="{{ sender.familyprofile.id }}" class="btn btn-danger">
                      Decline
                    </button>
                  </form>
                  <a class="btn btn-secondary" href="{% url 'family-profile' sender.familyprofile.id %}">
                    Visit Family Profile
                  </a>
                </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="container-fluid" style="height: 20px;"></div>
      {% endfor %}
    </div>
  </section>
</body>

{% endblock %}