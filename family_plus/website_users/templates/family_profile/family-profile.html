{% extends 'footer_header/base.html' %}
{% load static %}

{% block title %}
{% if page_user.hidden != True %}
{{ page_user.family_name|title }} Family | Family+
{% else %}
Page Not Found | Family+
{% endif %}
{% endblock %}

{% block content %}

<body style="background-color: #f0f2f5;">
  <section>
    {% if user.is_authenticated %}
      {{ user.familyprofile.hidden }}
      {{ user.pk }}
      <div class="container-fluid">
        <div class="row">
          <!-- Only show the Edit Profile button and Hide Profile toggle button
          on user's own family profile. -->
          {% if user.familyprofile.id == page_user.id %}
            <div class="col-md-3 offset-md-1">
              <a href=" {% url 'edit-family-profile' user.familyprofile.id %}" class="btn btn-primary">
                Edit Profile
              </a>
            </div>

            <div class="col-md-2 offset-md-6">
              <form action="{% url 'toggle-profile' user.familyprofile.id %}" method="POST">{% csrf_token %}
              {% if user.familyprofile.hidden == False %}
                <button type="submit", name="toggle_hide_on", id="id_toggle_on", value={{ user.familyprofile.id }}, class="btn btn-secondary">
                  Hide Profile
                </button>
              {% else %}
                <button type="submit", name="toggle_hide_off", id="id_toggle_off", value={{ user.familyprofile.id }}, class="btn btn-primary">
                  Ready to Connect
                </button>
              {% endif %}
              </form>
            </div>
          {% endif %}
        </div>
      </div>

      <!-- Display alternative info if the family profile is hidden -->
      {% if page_user.hidden %}
        {% include 'family_profile/hidden-profile.html' %}
      {% else %}
        <!-- Display family profile -->
        <div class="card mb-3">
          <div class="row g-0">
            <div class="col-md-2">
              <!-- Family profile image -->
              {% if page_user.profile_image.url != "" %}
                <img src="{{ page_user.profile_image.url }}" class="card-img rounded-circle">
              {% else %}
                <img src="{% static 'website/images/default_profile_img/default2.jpg' %}" class="card-img rounded-circle">
              {% endif %}
            </div>
            <div class="col-md-10">
              <div class="card-body">
                <br>
                <h1 class="card-title">
                  <!-- Family nickname -->
                  {% if page_user.family_name %}
                    {{ page_user.family_name|title }} Family
                  {% else %}
                    (Set Up Nickname) Family
                  {% endif %}
                </h1>
                <br><br>
                <p class="card-text">
                <h3>Family bio</h3>
                {{ page_user.family_bio }}
                <br><br>

                <h3>Contact Info</h3>
                {% if page_user.contact_info %}
                  {{ page_user.contact_info }}
                {% else %}

                  {% if page_user.user.family_name %}
                    The {{ page_user.user.family_name }} Family has not filled out this info.
                  {% else %}
                    This family has not filled out this info.
                  {% endif %}
                {% endif %}
                <br><br>

                <!-- Only display these fields if filled out -->
                {% if page_user.hobbies %}
                  <h3>Hobbies & Activities</h3>
                  {{ page_user.hobbies }}<br><br>
                {% endif %}

                {% if page_user.interests %}
                  <h3>Interests</h3>
                  {{ page_user.interests }}<br><br>
                {% endif %}

                {% if page_user.locations %}
                  <h3>Locations</h3>
                  {{ page_user.locations }}<br><br>
                {% endif %}

                {% if page_user.schedule %}
                  <h3>Availability</h3>
                  {{ page_user.schedule }}<br><br>
                {% endif %}

                {% if page_user.languages %}
                  <h3>Languages</h3>
                  {{ page_user.languages }}<br><br>
                {% endif %}

                <h3>Family Members</h3>
                {{ page_user.family_members }}
                <br><br>
                </p>
              </div>
            </div>
          </div>
        </div>
      {% endif %}
    {% else %}
      You must be logged in to visit this page
    {% endif %}
  </section>
</body>
{% endblock %}